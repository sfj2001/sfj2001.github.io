% 节点电压法
A=[1,0,0,0,0,-1,-1,0,0;
   0,1,0,0,0,1,0,-1,0;
   0,0,1,0,0,0,1,1,1;
   0,0,0,1,1,0,0,0,-1];
Yb=diag([1,1,0.1,0.1,0.05,1,0.5,1,1]);

Yn = A*Yb*A';
Un = inv(Yn)*[1;1;0;0];
% 诺顿等效

A1=[1,0,0,-1,-1,0,0;
    0,1,0,1,0,-1,0;
    0,0,0,0,1,1,1;
    0,0,1,0,0,0,-1];

Yb1=diag([1,1,0.1,1,0.5,1,1]);

Yn1 = A1*Yb1*A1';


Yn1_1 = Yn1(3:4,3:4) - Yn1(3:4,1:2) * inv(Yn1(1:2,1:2)) *Yn1(1:2,3:4);

Yn1_1(1,1) = Yn1_1(1,1) + 1/10;
Yn1_1(2,2) = Yn1_1(2,2) + 1/20;

i_1 = - Yn1(3:4,1:2) * inv(Yn1(1:2,1:2)) *[1;1];

Un_1 = inv(Yn1_1)*i_1;